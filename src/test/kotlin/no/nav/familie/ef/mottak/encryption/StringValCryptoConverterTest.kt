package no.nav.familie.ef.mottak.encryption

import org.assertj.core.api.Assertions.assertThat
import org.junit.jupiter.api.Test
import java.util.Base64

internal class StringValCryptoConverterTest {
    private val stringValCryptoReadingConverter: StringValCryptoReadingConverter
    private val stringValCryptoWritingConverter: StringValCryptoWritingConverter

    private val kryptertJson = """0xA07781C30AD54E95EBB1FEF12913B15C569B60A54112A785C1EF622743C5BB3F33901CFBB99D43523FC14D448733973BBC5099EAFA4C4D6F1CE773B8243B7C08F0A1770C171EEA197A90DD93D57A62AA7EE1C12AFD3F811A332C371262C69871669FC9FF41A8CFC5C73148E7212F63EB3425BC805FB491D7D87D4C3664FD301B35D08B0189DE2FC26C2D9DEB58074652D3057EC84ACD2426DFCCA6DE72D232849916EC23E91AB34115FA8799110DDB3EE0D1D7DB784AA001A678589BB3619F49BD2F18DAAEAD90BF1B729CFE68203C92A9460016EDA9A45E0CD9316F15A2FF33F6B6BDEEFB488B9B9CAE30EF6DD6CA727E5F9D1184E0D0E9115D8D00D2CA6344D8AEC882CDF596213BF4F2932313729AF84D1454EA54E8EDB7D5EC55B57F67B495CFAA1BCBF9D689A2EBE50A00CEBCE8AB2A481489A5BDCBD4C64172BE7AC69B0461C730869D445341CD0C4E021E5AC09441856F5555BCF5A39595DF17FFF0A1F310FB113FC5D700C165CA327D88637F97018A86CBAB9A4583387E999304B46A6A63E4146F5C949B2B6D748055341E4EAC153D58A64269EDA104BB6901C2551A13340B628C1A9A976143F067C35ED958BCCBC13F2184FEC6792AD81CBADE4E84CD6238EB388D0A8E8A005D3C9EC6C760BCBD92DE6EB62D3440CE80F69AF28D1439E9E98ABD213DDFF7EF49BF6B2913B62D5C015FD860F7D5BB5FE58C54711CC1319B124F65DD18D19DA2448D53561A5ECAA7E50E12FA3DEC4074D22407DB85A47940D318A8EE5644BF141A5241911A6BF9DAB2A10A0F443495F26380FF368FD0FBB070A78D1FCE0B1CD0AB0202B96746D4C77E7A54976A6030F02CDDD461BBCA069FEADF6D34DC79F3C9E7657022CB24271C16CF18AB559E34E2564EF4398B56AE99477BFE6A881841A88811CA3E3F1F10C7774FF28AB762A85214AFAF10F7AEB6FB62AD05241A789357F3D36A5EB2A24F219CFBDCE5595F6BE3615C5A246132170694AA3CFC5DCECA5D97138C2C2AD49DCA56E63FD644D1EB6B05442D66653E5308E71C2B280B47BD7D6BD0BF75EA90FFEA463A9C2B9E3737046655B4D888FA315E07020B584A3E744847A28CBD13238DCE0C9CFFEDFED99C8FC06AF83DF2782C3FF7D72B0E7FE1282EAA78E563541EEA96FB38E24CD63E38BF47862545403B1C67EC50C03D2B69EC791C6933B644660B333675491D647382ECA44ED2B97A8575865973DDAE25B53E46258F3E799F1F49207DCA70EC161DD995281AB1F019755FBC99361A6E139064BF0A49B2727D23D1B5547F7A7C05F1F50A91E5542CFA2E06CC04FFEA357240C6355C56EC3FBBFCBD49B0327F7977911A6D1042098E2D985A8C4FC2236D491CCD32642025C7397BBA340DF94CD700A35F649DAAF34FAE31A6E4857504B0E761C84C3576000F7F303D7C9A71BA7EFED58C24776C174D7365CAC78B2E38FC880EC9581140D6D428BE940DC3B930CA03F200E00BEEC806C0F93C81D98C363162FC3ADF3AFF31FFA2DF79485D329A7290546528C31620C094E0F0AED74FE642CB123F6929FDF12A9B85BE92CA7672ED15051EB38224D73B3B713EA6F33D3E46E54CFB9FA763F1766185E850F759605DF4A8575D29C2B721BE8D482141E30FD71E400C4625F04655339839BC17D37B76813E26FBCA0C922A530FAB19FEDA5D82683F2E8CE03486F76C3AB51531FB11BC533EAB5CF9A8DBDB20E655B75F6EDE650A80409A028B70F1CD28F9F6C07C44187B3A795DB6D90F5463ED11298B81E23D13BA06B74747F836774BA5316DB10C438C44C60B5772774BE9B198AC094DDDB8C0F2581EFE15CEF07258C15B20EF9EA5006B5271699835722C794DC8719D5D5D7199DBFDD3F6EDE7E2C8848F34A711739CD63E1402DEEAC8F18BBBF331910D116D79C983C49325F299D68F0467F306194177932604D5480679144152A86BD60DD42177997FA80EF939896F6D3E3A77AF496BD2AF93C96AFB6440721B9E2924B8EDF852FD6855C14C6240BC255D1B1F1CEFF9724BE0AD46A2E18BBA616336A2B34D732B77B73921ECAC5180393DDDABA7281F41E15A9124AFB73C6418B085F920A38E693C7538C8ADC8355997B73A70E73393334E727ECBDD2A904CDBD4EB4C2770B92BDE678706D248623E49A25198796F87D68174E3B50043F3B5DDB8AD0AA97EEF3DC9C8B7BFB70BCA56FA05DC9E8E1F6A928A69821F4B513532620D860C7B71BEA46F8DA47CAF5B08EB5DFC39442C62B9CFA4CCCB3603CED4C44473C6BE573D4F7EE2F123CC27C248FA14210A8DD4852D0F319F20D47118A2DAE6F35A2F7275954581CAD424F65F703BD600E7E596DA71020CE2C7DCAB1666393302D594CBA484080BAF43B5FDEB1A8EED09231D93E8192E87B59DEFCDD1B0E990E642D40EE8DC6074B021C3E12D6AA763A6FBA76B9C084170383E7A524944020E5A09538D4C47AB40493670E28389F5C1217869F21C2BF4F8E251155A483D54F6666C21FA71BBBDBE6C52C87D059E68D41EE84B9CC648B6AD50D9FE8FEE4B06FD5E684AD5AB4C92D8092F89F6B4948B40B422E05D45DEAB480A9338BBE2DE4CE64AEB68C32D18A87D0DAB11A467CF4CCAD16BBBA8F5B61A0BBC4431C7DB9286BDA02AE7615F55FD6900AAA31F0F78E09BDE9EDCAA79FBE51A7B99E567386530D94B3663CE41739F9488736C59BD91C65742B4F36C4618021F7182D2A168BA4C4EF402C25AE89B5C02E90EB0A3FB3052CE11A387F0915D3526526ADD901B622DF8B7093FF4BDF4DC0F7E7C0B08112C2E5B41FFC6AD3246B03175899D23D6F2BD442BF016DDBF9DF7C194E610A75A722B084A8E36509BBE7B657A3B60F865EB2794C926A8CF0AA57D0077BEDC2C976D0A4C424BB448120DC1A866A1A384E32852E2D7166DF4927D4E324CA99C03D68D343CA1797E13F1F4B3282826214D843035FA3E5129B5BAA25DCE2F6DC3F56DC15768E627280458CF09687C155E1B1CF31B5284C34D0F181B88E522E788D44E125F6CC1694F3802FC54A58001138503B77926C9BC61CA5B4D6021AF335ECEF42446A2B82CDECCCDEE97E637CA7DD035E1F967FB7986E840E3C187EC5B5B435A0762AB39B35927AAB246041894E61991B80478E5C9579B8A208E1735E0A126A626C6A400B28349CA97AFD10749FE50AEB0C02A134A7DE9DCC68BC98780698C9AF291C4ABC80D5204EDA5E69D042114721E7F89358E3A695AC127316B98746EE94A1CE09DC2A62ACB7B7AF7272926D94762D1EFF197E14EE0F8AC2351CA25997D1CA0CFC863918576C867ABE4B77A7CC1CB7CAA4DB8F7254D0B70FF02831590437A13C6CADEB8719954ED87FED19189202333EF4BB39F2D0ACBB6764894E28AAD2163C63CF9FC1EB60BEC7F554A1FDD19D2F9522AFF8BC31CBEFE80962AA9CE0980FA9D9D6A5736F5E1E6FEFCA185433B8007C0CE1E3EFD1FE5C0AEEF0BDA6B081308A5791ACB22F25768D3118B91C30423D6952B567F9BABAF0E83C744835471B1FD739D53B137E26E66E9A79BB5420844332B8633AF4C9A68DB8E79C75DD5A7247622996A50535706384344FF4E13160E7EAA7E92D20C539E6FC0D2E5BE4A3502A75F32A8292995DEDC36DDF463E78CE9A48419C21B3888E1FC87662F21E63A513ECF0A54ECCEEC32A0A366F2848609F4C1B006041327634E220052374DDE8EF46E2BF4A241527FB94736862B73E2433D96BCABC431F2A2D9C7BC793D15A9F148902341C3DF45F853F9F5A78AC458F00150476457C5CCA4A9F7B2CE4205756F9BDD3F1AB1DE6C43DD6954064BA6D3DD2FFA51BF35A33A58584D584C0ED69BFAF6F10F52FCB176B81E94795775E5D9FE57A8AF8F76BC0FF6F2DAF4EFAFD27874B318BE14EF8255CB522DEFDFBF29FA4EDEF2D2CAE1E0642EFBAF82EA4C342A3B724127F4B9769E922371528F1BA7FA86508A6070FDEAFA28E71F6BFCE3F96ED8A18979DA29F93864923F1597453E9E107AE898C37566CEAE60C1AE906868A3A5E54F613CF4AB8B276CB904A0A2A8AFEFEAFD694ABB32587F303E46BF3FE8045F0F63F74A648AB702FE9D2375B2F5BA1CB3D4188AF6BC797E7118C3878846C947C899186AB947FC3C4685A0304DEC46CBD4C8CF282319A2BD900F4C6B4AE60B63971E452B538239404B2F84375DD2EEF0CF15E3B2B50C80155FB823F14472D717D4E573432011E23BA3D4FB1F8E7C6633B39C02351DD174592C5FAB8FC4D857C0A42CC6AD780C4C5F6AC0B12076E87EACDFB4F7AF984EEDB2F0A2121E620C1B399E11F4CBB05044F8B3925C641679A44F5F367B9222E432A7E4D1D1D6E66C58CBD6F15B3296D0BF6D9CC4CACD1A6B87519010620D2080A3485DD08D6778A272DAD0BCF3758B56F171B63A146A372C385FDB51E247C305DFE0AC1CCE88E6DEFC2EADEA9E0290EB085FC7A9E06C57F336ECCEEB6FD53722FC4C09021FCB2C3D6F8ECF3BCCEEA6AED19C455552805CC37574E0DC03B7DFFCBEA923677462FAA32BA4CD0476C71282F0DAE0633516D0CD97C82927DCEA407B15CC1BBCF3C64E4CCBAF3AFA86D50AF276217B31D1FDDA5B3B7BDEF8AC602DA0611A478A655BDC738AB3C614C3B98DCD4F80B1AD1AD2FAF13C35EEC14017C77BDF7FE2E0ED48B70FDFFD4DA57EBDB67B81BCA19FE93F3450B6914D894AED62088F1F1C328D563AC19F62A877B0F483D1156D960A899B7E437C2C749E03025DB66AC582509FBD2012C4F5DFD8846B17F58AB64CC9637F776E9C820164D5403E5DCA57CBABD07190C70068B054F04C686E59AAAAD9493229B308EE7FAA0559BEF93CA07F3FC3ADDFC2ACDA053DEA51272597CA6E61F73B1F999D0E3B3703A4D8E92FB72F9DA46DA0957782217B9F41999CBE1FDE7C00DA03A5782371EB1416237198339794F91FA1F7D80C723EF45E93C1C35EB152FE131F566F2F4B7D162D8F4893E5E18C3A008EC28D65C26FDDC19B252C38365AF1668D5C2850496C5DA1C1AD3A9C9A2EBA5F9C2DD0E3D109E28A40A790D0CF652C8DDE7122594C687EC3C4364FC7C9B51EF1E83E9DCED7D5483DA8BF4A3EDAA647C5F9EF5680EDAAE69C3F3D3DE8A23F7E6609AE05F98FD8999AFA50211596834045A1CCFA5A0D54CD6BB644C8B59250612677470300AF5487F46B45C17C4386E2B6F09F60478153CC3F58F9AC1302A196D392FE38DE1141020C48CDEB558C0772A21AE713947B7E3F6E9C4472850BEA55A8BFD8F8157923B92D1E1585AD200D8122CDDD470D35941ECE427650E9E72C999240F5EB58505008514430543BF36BB31E7848787E62E1652790FB067B07B056A214D32198A8E61C31A2628F8DD86E1B8DD478B597D95B8B29B96C1A1E5577F4D672262F0D49E8218DD42810F1B58FC755A79903A1AD0CFFC06097747BC365F830EEE1DADCDAC143D1F439840917299E3D78E1AE75310274BF6E7D0D28231A6E3C969E31BFB6438DE6BE240E6C6786E9EA07A5BDC2BC9E6992808858CCAC7351694D00024F18B0C3920575B17AAA99D9D057C61035881F5808D4A7715EE1214BFFC57117D5E635159CF7990A2886279F48186FFB441C2D1A8DEFF22236B39544A206F161C9A8C8529B01EC6E783725CB23ABA7058957D55F96292F58F257CCB3C154E6990E0A95633EBD1665DCCB55CCFCC05886092C542F5C2F2DBD82A4EE19E77C2B6BBD29AAFA274C0B36462EFA969A1E20EC3F00C7110FC8D3DE107F8BD2BAF5E297BCA6D89C57FE3DC249EFAC16912013003D8447BEF35133914DB0A52953E6852291D688B6D5AFF539688C43DB27E2E8134DECC2CAFCEC3213365E8A3A4A77D1AAE777865BC9902CA4F11ADFF8E91B7D02B20B6C8A4BDF47B2C4FE3A0CF3BFD853A23DE05190B46E061EA64410B5BDE2DE0ECDE9941E5DF8DE88A6E5ED6F3C6BDBB8DA2ED637BE380F2C84FD378E6BA9374D5C291C720EE842E6679D7D5C28541A7A63CAA76EF0F788454D790A31AF9DD5AC9A8C61705EDF25D2951116C7F51D33A8C6CB2D1B036DEDD1BEA8D42C8C4FBC82C8A616E259DC883D86B02297862FB2F6A791F9EACFED742A5456D3543DA91CF724CCDB0D49121B80B3EAF0F433FCD95F360B8DD18AF0D6F9ACC6A82B49FA249AD5694A1C0E718618C17F628D0EA19886714FADF3B7A47600290AA0E643AA48548A6D148D1C287A2B69E4E1636C50A20DD2001DE546AD6D9FAD6936989D028D24F595802A1A685D10D8B3B042952B719CBE101A5A630BEE64EC87C4C8189373908FE61F67701BD6DCB3873EDBB42DC02FCAC0BEAB59F6623D39ABF2AC845394EDF03355672D244335BBE25073D85CA5A35F56048A31E23454131984C54F60965236278EDAF4DDD3B2442E9D7CD91082F8BD0F35182E36EA9380307000025141F31D0E8EB7A76CAC5530F7AF2EFFDD6A79EF3B4079E804718135CF10B17A9A7712438D48B594A5CD0E83D4796D16A9904BB36FA59049D04EEDED4B355604BD11621073FA9865E7D706E973E4397E5EC4C0D0A2157CE6F6C348C404208C5C1D2808F38404E84FF644EFD89B59CB723FB0604EB4C88ED1585D0C52B68F959FF9EB8C311D0778855F0EB1196FB16EF1AB66F90589A3829E2028976F92B87870C2C724D420071DB3CE41ACEF09DDC47DCAD4BA8BAED55C4366D351417873DF87888B8E072A116D3582F581CDE199E3CFAAF9B9E2A09A112EB9FAEED27F77F106059409542FD0BC6CC1B99A35F455EEFE4F86844EA1B94C13B7554FDBFA08AC662B125D7175E5B014F4B7654EFC859A323DD38BEE1712D4B592E686809D0B6441B4D2D8274EB5492ABBD51DEE177B49873EA07EC4C331ADFB9BA2A7E0EC5B87A65591B89F219FA51035DB257A518815718D3488F5AE09D3754838DD34A09891AA455022DEF0EB7E5ADF637DDB7146E2C56818634F292D1C0A11EBB5EFAF17B0DF0771FFC996E2BAD991E2857F3C8884E4E7A5A4FF401F7709F4140765CFA713408A2AC82B64CA9EB709704869DD03BCB0344726700C4E4C91310F0E057267CEA994E69D028F1C3EFACEF8042387F605539FA52A3E91D435575A3FCBF88C0DFF80BE19CDCE317786DF85E440268F810B13FDFFA223AAD6A7563E456ADCF557F20302768424EDACE3948AB681C1BF4040CBF3AEF8B74FAF2C6640E11912F82D1DDDDFF9413D8FD85100C224A20E3E89A06F07541BB7C3B2145D69CD911958CC2983795B1704D89595CE8B7C9B006949EA286F923F48989549B8ED6B0FA3EEFD6405F00F1107CA3D7D6BF4C52131A5A45FBB7F599AE84EE3D1A8810BB1CE2A07831AFA38C92CCFDD8BB6E5C23CDF738C9CC31EC9FF608804FFFFA73916F48FC34C4242FABF87DDADCAE1745907FC392171674E07174BF7B5CBE3FDEB09B85CFFE4692534BB284842C147B3B4AC82D663E7F57FEB0815997A78D815504153BDA162979F994110AE9F0373D9CEDDC7CCAFC2DA59A26916B456F53EB517290B26FEB63C04F27014A46FD79D782A046DF5F389E6B97F0DE82313F84E20ED5102E8A04F544FFC72F3D6D68BEAC2A149B96F977DF8BC121FE878F652AC4C321146D5374033E812969919CBF6C3EA091ECE4F661424D5CAD35BE5F82806D4CA982835524CCCD7E70C44FA71A7ED54F0780066EC3B3B7E4816CF1BACF5A9017DD1A12F30D67138D34A708D11BBA11DABBA1359CB5BC28F1EE6E51B46760C3DC8AD0A5CE5D029E5D6FF7542E5A2F06BBF37A1C7CA24AF579430CF3700863562FB4A97C2CCD114098354DE96A805C52C36F044B81ED20A64699B33C28B3460C51AA6C77F8E79325B273CC49C53010C45452DEA095801413EE8F789E5B53CBED136471286AA13F63FB8D854D370156A4FA89B8E2AA3B9A204029450017243B95C42C0E358F1772E47AA6C3062096DB90BFD5BA9EFD8B272C5B293B3FC403C72B693A77678F6C58DB20591EE84F05BDB42188C137D117CB457B1B7C4ACBF84BFA943CEB9C6F268363F5EE3C44C5434EC475A4CA2BDCD85718D6950FF1315B702FEA59AF8D21DC50EB0A08BD8100D3CEA8A2B50D430D8247C98C98B4B89EEADDAD51FF2B30D52BEF0F2FD1646346E3EE4824960F6E454C3FAAA860EBAAF02A32811C381E0A611B32EF807FCBEEDFA94317DD025D5CBB44CCAD629932D4A0185FCBF3B22F7AF7C9D75B98BA87226A763E52F42C3D88A6C80CEAAB089C5EC7A0D2168EA727244AC8FC23DF6E645172C6A7D7FD13E28A0CFEEF0AECDB37AACC91B6C9A2236C0CCE9C1A13D8C249BDC35853EFF2ABF09102658D707932FDE95B9CDFC11C34266133A81C190CD1F55ADC2440BD6580FA50C77B965433DE0F5CB708D9808884A80BF8F4977F3E93D52E758474D9342AB22F7366194EA6C0AF9169EA2CAD1516C24AE06CE12563C0E725ECB3E507965320BAD234615CD0837EEE12B25D67BFB48474878CB811297AFCCDD005B32491AA475A2DD5214A38FFE684FB4606950537315D1E638EFF3E68BB54FEDFE0F377211B7096696CC29C19A25FCEF4F47C736FFA83FBB6374E41A3F444CD2F00FF05E4C4D94AD0C7DE837E227C25CF81BDA19CF37BDB302918E07A7A6DD354EFF306BCC14EA5F8A5466329F50DFB75EEA94B8B3EFD29C2EE3ABF0A607AD1D22CBB2A2BC0715703FE5282F4655D197664EFFB07F6CBA5E1D88035C47B0CD08F536576D02C6A8AAFDCEA157370F80FA3C4A517BCABC897AB133FEDCE03AEBAA58773ABACFD3963042D6008C1AFD9FB8C06BA2AB9C8F0AB723BCBB764976473ACCEB564109E37C893C53A890B20791257507714394529D3C118E92183884D2259BAB1A6DAA2F3287DA35E0FAFF2B5C0CD70B75C21C9FB5C77E7E7D5282FDA4EFDA972B851015AD055D02AD1991ECCEB7169582315DF273F51DD59787D506347FA0E6325BECF95B7096002C0861012068B52E8EE0695FF673B58DF4FDDBDDFD22D98BDF337921B63C298426E03C4F50EEB9BF8EF4FE9453D1F04B3D7682C27D853FB0060253A3E7108EEB81F5EE831E1BA70E1C8288554BD73FE68F2CFB08BC0C68EFF9D02545F310E5D5673FB55D72F5A1808F95F55253DEA9BC7810081FA3CFD5129E21285B7081AA339F23384085CB5091E5C4FA4E3E26CF1E456A11A2652175A425D04A37911E287D3D098FDBCA2A0D86B9052BCACA7E120E0E7558C8B10B3B91CA33300AB4E17F87C430086D2A0FA4768DF601CCF677C272CD0283B10A7AAA2A82631BB01167180ABB88C8917CC8B9BA51902B659E8F1D228AA15769FE35046C2FAA0ECDD378F004A1F8C43BA8E8F2381A98A4DB54B376020C7D19D6678A18FC2F671E564DDC4BA1C9725DDDB066A485C594D644508F4F920A944F2C1806C8B526407A7496E95844E185F2175197D070BEC22D95F32112BF316A124CEEF534FD7C547D722BE3EAC511FC0AD34C3C8CDB7A67EADEA5358BD19ED4A456BD7D225707DFE4BF0BC21728316112F725EFA534D982B9C7B801C9D5A38FE5FC9798F68EC04C2C40820FA890F9097E721247010E1D0469ECC8252D96732D018E1A8D1959FD404144440634B132AF5320C644BFD198DB42E80370DA571CAD903BD8D6ABF23F42548F04AA6EF0ADF96FBED005572821E71B31780DDEF2703760AB3F5923665CA98320FBE7C79D5019214DF5EA88859B63A6D6B15265F0AE48E149DA4D5B8E79D6261D525EC448F700C9D34F5AAE611AF8C971D2652EB6B5424F82A87AA80FEB019D5AC84ED2E4A655A25D9D2207BD942C041644EFC16277CD1930A7EFCE446BDA80DC823B5B3DE39394D3E44074DFE1D345E595E7F654F828777237104453C52FCA597056EB0A0F445FF83473779544EF3D43355C9C128B988AA0BF1B791CC1A2B2A7E87DD1492DA4236EE9E377C5ABB9EFCD9F307FE6C2D1441026653E89A13D476033AD61A4243490ACF5B6658F1A0545CD5F1BF2F4589213F37B9522A7542D2EA4D91862925CCEEE16CB9FCD0EFF27A48CC2B6612A767E28B9C4200F1810297A5AA12EBF0CC31420FA9F3BA915A51F6BA95D7FE2F40F93905722211ECC421BD8E663B92E3A01761227CE044CE8DAE87A4AF12CDCB9F2B097D0062ED90F25FBCA0B1DE792293334E345BBF39BBECFC719A7358ED59FD428F666AF425DEC4055ABB5291F62699101AD83E81BABD743D4EC4147F9561A785B6D61B187A925DDFC45ED7446DB4A3DA0B6C3FD55DF64E495C9408B072A68F2D2DB1292698F0B7CD5BD940220811F539A6270FF2EA6F2AE5CFC379E8E83F22B592663E70CA1567993A735CC10BAD0756ADD3922E6FA812CDD8C3EE33970E9EDC25DB239922350DA9C3A382334F552172AD793ABA864CFFFD996F5925A68D70B6E85B09251FFF6D04F7E97CC83AA73E8B35C53B7C740F07D007AD675A302CB3981EE87B753744068875B2C46960D4F1B53797EBE47596E06D207F947DF30CDC2A77CD13CCC726D6B4DE37D466C36D2B43FB732CED090E6495C9059436726F10F79B4EF7A5803C5979A7797F80AE8052E9CA0527C1305609AC71059E12E5E976B7D56D6484DFB70C98B2AB041D64CCBFDDE7583ED55423F78230298C21C1ACABBAE10BBCFDE1820D5F66EF119212BA45AF377C89E75117360FF38B2997B827765E477A97F769E273CC4DDD236352BBD6A7CDB219B553ED39A78269294435207ADA657E7772FDA9ED983E443A0C2165B3A9A1863473ECDD8B90956F03E79A59245E40C72AF669E91BD1E2622732E4BABD9F7153904CE9E97CE0070896AF7BC7DD0DB39658CDE5A6A40C50E82964CA795E237A41A2E4C2362ACA2D36FE4C5913D586D9D8D40AF11CCE40D6AE934F77AB64E0311F441447067C395ED24B0253F66853AAABD9A74879A0E908801986A535627465B174A6414D9A561C4147D105D2BBB54ADEE7B79AA260646228D3EFADB7191232307D90F52EEBF23985711A703ABC0D3A0F15DA7A71EF075D7FCCFCB24793FA93078D02F11CB1EFD2002F29C9CB0E38F0812A4A907F01509FF4EC11CC3988B48E6E834B072A97971A0E27F0744E5183323B36E27F72242E0974E7F30F6370F440B0CE6E866F2C43988C3DCC5FC5A84E8CE1690AFCC5905B730B56F39A55675F6129A2EBFEC1D496AA1136AD03825778DDA410C9C8020C0C6AF994C0D66F6CBCDC51E889002B098A301F0A1F16274DD804DA78C8B3E075897171D2FBFACC21D0C5BD4EA893B675784179D48B8A8153BF0520174CCF50131FE29819B4589F3EAA7B4F87FEF53444B625691831A2513D8A93A32A87727FB25C3AAE07DB9CAFFB929D9CE71DE46E6EDC3055DA60BA5E779C10A0ADCC2C9EBB7BE52345B5740140A0CF82F4F896B35441C942CCBCE17A87ADD4452FAF7AE750F23D05631766D2017BCE12E00872F8298A054F12D1A1987D0280B80A5BCF0469CD2062056E0EB94324681EEC4367F916BBD2879181E4CD0A422AD38768B0AFD161E76E99CE980991CA30126ED30C0F0B83EFA8D2DD31CF5027CB93487D093D7780AE15F364A43C76A3E4C58B92D0FE5813DBD6E198B34CDF983A167E26760AC3890C2F78D6B198895E6072A7A74718ABFF96F069326A6D4EA69343777F022297A21C7B57424A86B5EA6889EC27DFB5094819D407783400241C78C3D095693C93684EB2B677B18CA6DA2C36FE7358AB459195B082129DFA9ADB1BF7F1E16612C4304BE6D1D3C8F34F53F26737AE6ED9DB445A90DA0DF773B94CB173560E107D27F9476959EC3BBDF635477F5C7012763F0BF2570F8078F3B572C724138A3EDA00B39550D9C54884440EBF446EF1F8E29E5D776052B3A9AC86CC77E7B3A0B16F34EA87275A08A8B2619B244E3E296A3BF8958A15073829E1C02A36B9981E96FC9CBB60329F3613CD23CEE57CEBA20EB5A43527A380CA386071AECFF262C057F98E8267110342FB335719805548C60EFD50D06236A6DF66D9448EB615EFE995DD83D8E4874B1A9CA7C51506D9AACD455EB8C6D1F2C1A5B355A76DC3F3A891158D0FC173CE48086BBDADFD4848765868DCDE3927D8EC76450B3D87E7C9AE0F188C5BB6BAB9311BCF0B9811FC9A9972C60D606DAF5D362C6288C70C37AD386B92D7487F16F555593EE447D446F625DD023D26657AF56BD5A690AE7B019441C04D4F53BDB0B900A8FB4F06B867284F1DC504CCB32B40C77765B7327F7C4CB37991E381223DA9320B981F570DF091278A78CB680404FD20DE10CF3B10C5F95364E2DBA60E31BE7BE987B9FD19280D027447FEC2836B6520E264CC5603DC15DDA46777D7A743447B37B2E150C7CB75E7ED9073369B6C43FAB5ADC65CD4CF86CBD4CEE4EAED17E52FABD2048D19D73F4C2E4EF213D72873D372C3EAE8CEA64F4218931AD757EA13F95FE8D09D9EA50DDABF83A0FB728A33DD8BE195347A68D175244258B756647EB8F4BAD29DB4CA748C4E25FC797358F7747D6BCD6ED27B0BEC96F75355D08794D3FE4F3B6B212FD6CC92591669FED4F2474091322DC09DC6BE8475AA7505156778893C6F37B947942CE2D40D4D713279D38795A5137055E881AFFE7C3BE03352970382DF34B5A146BA5CC482FAFDD2C8B7CEBE9CBF2F137FE9DCEF0B4D8EDA7D2ACB354B7490DD7E0C696227D5324D65AD19A51675C9560A505C55761CF38E04FC441A7B14E4D45AE7F853FD2D88B752C159844D1D1CDE2C44B6A9563D0E2562BBD9269EB16DFDA0D1AAD268632F0D19EECA7B905FD1CBBEC9BA908B137F773E1172BB8352AF297C66EF2B3A893F7C15A3C8DE2B0BAEA66D0BAD391DF59ADB7553CCDC27EC10B269725AEECBFE98C5053FDB16807312470A5EC231BE0801B7A4F2D25462FA6764ED73CE4476D532FF6E69E8DE101CAF28FDD0081D2F476931BEA49D8F2FD14F3B773181495D7A36A5E64F1376B7A5E4444FD4F0338EC83D2DAAA348D8FF5B54988BB77D017903E32883EE4AA82B6033C352A7927F21C82D56F2BAEB88525A882B229E3FE98CFCC8FF95A8F2244668E3EEFC213D837552330CA80B71F963025BE4D5E1975B7BA29D563CFDDAA18D1B183D25770FF3FB0017FBA71D7C332B7988A1ACF92E9790507A5F866D91A75F4A528259F7058CE677CDC6C0D7C5608695DB55B4BD87C0A4EE9FAA181DB72137AB9E4CEAE187C8E3D6B161F3542A727490742ECBC4A8470A2FD9D4DA2534920A5F6D3F28DDB567A96C340DA5721AEBF3CFEAC9502EF3DD616508A271AA580F1A41DBDC41A59B63E3A38B24BBC38632138FB858F3BCA5510EB286063460105E410B648ED1010163DEF397D803AFCD07A546B757E5FAAB5943434C386321715A06321194397C251270423E5B5A27957CD66EEF330706463AB60C77F268415C132FBC351F36A4CB4051009D2E3FF1714895110A7D6CD17D1BA6D4DCBD07D9C89114075F3CEAA520CA84903CEF866AA0655D59496A6B35B4DE428D51F74189997CBF4C4DEB4147671307A48D0DB0DAA31934C833085D7B0ABB138A03B4F318FE1244FBE4D6016E5F187A034BA13EA07E4CCB3C7D40B9027986F5A2EAA85E38B59CA7360A6F14B228FB0B5E4531F61C53041D0F1DB2C30029AC65D603BFF62846B7304CA6E5FA67EACB79C06606BFBC478DAAD5911FE4EFFE7BCE6F6EC231C897FBC7A60E5C1046BFC5F1B546133D69B5A064EC1B5B4ADF58B0BC501299867C5A2D63701140FDC5373F535D9136616261D665F04F503AF5B1D05919FDAE7BFCE291125CFA757B32B67F79702504A7B7ADDD2B8A1A4E1A7F09533F42C547C78FFC9D375628C2B294478C9C9FDD856FC5BF99DCB09CE5BBB487620DAB44CB43C10CA08B9524DEBD031CBC6780D2F54B41AFD1F239580A6CC2207C8EB0514110440EE806F3C6B2823D28FCF628A03A88544E0157B4E5B3AD65B1991939C92BC7F075B6C522376051BADDB2AE6B4618D4DA62DDF255BE744C3F1B2817710C80A35D16B528911B1E1135043A126EC0FB3AFCD119989DE93D34BCC6564BD6782A052905140AB53C9A8D23E491CCA929C5C8A0AE330FAAADD721391594F5EB2CC9EB22E2090328CC6ED95A8F345A254E1B439A5006C4FB788D4F604D812AB979F9BF3EE1E9C23F824C3B4E96AE2D6A2AA9083E20DE64970913B73DADFBA0BF07981F00BB54CA94CDAC87650D8B5B91EE416C5C3BA2AA5C0747695221545F5737F89E9490A1838029E4446D257BCFFFA6BDCC35DB85D72F6508BDD8D9CBE86834700CD4705BF448DFE9DE99037307C1411F9C54A44AEBCCA884569D86E4B8A83087AC951AC54C7B8467B210C4630E4BEDF00397CE26DEB537F666D25DF0E7C295460D85E16F9857193EA93DB277052120B4D8EC2BAE3989DC18BCDC770FD1C7A52E7213B81476A70CEEC97A3BC1422208096695ABD78923A27A27320FC5A31357387C7F9CB0374FBF6D86669F96A9F4638B0CBF4B5C3368BF7F65C2ACF89C21378181BD18DB1AB78C60E0FCB0474CDDC5741BC6E56ABB377056CB7E29D06C1DA2E9FCA491223D61E2FB2A382421DA9511BE85985419A6F6B07327FC57584F32E14385594329B67DE81DFA565543AFB12E578B90576D02784D39DE5A9404B2182D1F4F38BC4DE7B041BAE5AD4228ABCEC246DE33380F1C733FD1CAF564C2D475C69BD6DA8F7F047508367E56013D484ECE3AB6D217F3C76E68803EC6E5DCF169DB59D03B40D5AB5809A9C79CC1738A5451A0A3F73D56D6B1D8F2CCA63D085457A4BEA5869D2098D075B7A5154D5DF3E5DD03D18714E1B9ADA309C951A57C1B178AB00B56B887C7D5B54746F4BFACCE30FFB62A3067558ACBC1B7BD4A9B9F3921223D178147CA4F2DCED82EB9DE4589CC43C92BEAD3C73113401BE5C905E8414EE5AD0507291A5AB2344426DFCEB85A2EAA5613C479695E448C76F8C64715C45C6CB4B2C210955776E70E8A9E43899AEF118E3773C2F9D813A40E6E413E8E3B7BAD704D514D42F55CA1D64A51014BD4DA291630B685EC0BEE14EE062877BAB0F6C3B38802D317C9AD602F67DA5EF380572E10CE4ABD143E82DE347CCCA82A57638A5200C21252E231CD7827029544C946D30CAFF7554B602E25DE33672E9D20A28AE79A2BFDB08944688DF7A74BBBB54A27AECDB4EF27586331734E7C6AE03DE4CFFF8F92C2D0820242C963CEC1F0DF45376857804E3C8360150698FAA1B6D07168B20CC7C3A25D2B65F0A61761CD4200CC2E767465343413AD3A0C65AA2D6B0A6B1BB59004CD2434FCEC03F3D09AA09C56408C45B27773C0835EEE4D20E6F202915EC121AC5E5B50C538F18B3943761E3B9DEE23587B31D5B40D463AE4EABC8D08B9E421E5E8F44EF3786DAE0A7FD888BC4B56B93782D1A261671B79CEE8D7ED7A3F913C6536A541E47CAEEA2032DA86EDE6514BCB9B0902597D58C0FDDD12262E0DEF2751A855AF8A41DCA810A1DD442826F8F072597E8A90163D0608FB36DA579F04E36B22DFE1FBF7C2E424F6BFA1DAA43EB455F79C6B48785DA4322430A3C12E8CEFC64789A725D56C23BCFC28FCF143F96A337E44A7A9EB96BE6ADD5762ED31B54915AC5B9AFBF0DE1694FA9AB5E25A5737EDDFEA9B4060DEF8AC44A8772BDD0C988167D686E3C4AD4C7BBBB8CA858192F29D10FA40DDA97CE4DB7A884F2D5B261301F0D75F8FC3AD2BCEF6F01780CA83049CC01E02D86FC675C02C300CBD733147ED2DDF4A694A2236D6E7BF0C124AE8FA3AB329963C46E818553BAD3225E6B5ABBFE53E5D9FDBE3F14D047C9B8E32D8D7E7F20A90AD7E8BD88F516B348485CE0B5D2C088F3A938BB26FA5750CE903EE3E0ACF29C6CA432DD9D054B9F093512A51A3BC099F0B48816E7672BD49DDAA33332A65FC53ED50EDF3207AB6319D3C554F1702CB1934BF75AA9A537FD2E2F4682F3AEDECD5747265C099967161984BF0CD1FC82E63525405C3D1649BB550133CBF0681B3ADC08110AF1B54039DA30F44E03FD5833CC8CCD7C57900B29F14684908C32A1ED38E5C942F531EE67ED95B4A9824DE86B39A242434FCD228A43AC42F98046430170A6DFD0A2DD9304182EDEE56C600908E06422C9E7B4B4D3C63DABBA879849AAFDB649BCA1561CD272D46B59ED54EFB8BBE7EF00E2F66EEDA9F5795C1BA717AE7F060DD182A6E52E652EB2AAD539BEF8A876BCC3A9544DFAE5521222C272209A307336C68AFAD608CBE744DB0B991E44AED8288FA0A66B931369A20351DA926C78DD67CDBCC5CB1EC0195BA63C94AE4EAE0B47EA965FC9DDAFC5CDEF1926D9A9918540DA321A402CA0BA7E180B55E3063AA437D61E49B68797980A95757D22D40B6E3DB64BD5DB46AA1D7D5389238331118CA14E8CBF034DED311D18DBEE5F642191CBEF8A9235A76CDD3645AEB952C6C6ABC9F1D3F6450E32AAE04D2FEB5A5A83865AA3BF349BF5EF9A11EF9A6E0FF4F717E15B6FD192A5752FD517F2C8EEDB78CBDAC65BEF5240104E6FA89ADEACE062A6D60DC4ACB65D2CD45213D10FDC52B77045E008DC5BD6D2C3AA6F22197288C6D27C9FF09239E63419A4E0AE33A8A78DBE56392FB3DFB731DC79C764DABE8253247E052E02A869EC0E19AFBE846804AA8A3E396CB895CE843664A1E51F921892E453B091BB79BB3BEBED2E60B56300A6D50684EEBC5ACF8D5CB460D26C93A3B217CA2CE59755FAE7E5EFED630F597F81CB09CDE8847A35E207D538F541E2DB1B897945207C0B18322C0B78D62974E8204F839F32BE1953D1657F2ECA0BF5D1FDACD570D2CAB07A4345CCDB16CE9F9F94289BA8763D7D71687F44C1B95499A08F2F4C801D2D3012545BBE9FBC61223EB9C31AC61A102803ED463DD6DB9B7A40FBCB1545B3A6CF55E76A66B8B803714AB149D54CE68BCA64288196A9BB6F9622499B1D5FF92CFCB5D2CF550B93A9B5F688A70B2E68D003B018120A144FDE313910DF242A251E2F3FEF6275EFDC14ABBFA32050FBB99F223DA7E788FB28D52EB26A4E7FA12E258C0B8957AD0500827B41152946A59491273E0EE866375A768CD2FF374EF0D9613DF86D20BD6C3F5D3E789DC3A87CB6F14975CF1296122B0885CDE846223203331BAA312C0E1DFD0ACFCF9158DD27E630CE93E4198D3DA55B3A39478AD0EE9B33C0E377ED396C3035BF2002EEC914D678A83390DF00B58026B1967613A73F2D293E71F0FD7A5CE05E143E9E32D0ED281B222027BADBFB36BA69FFE269C755ACF7B9DA0DC8A194AC8A78B1F15620FDB1AAD5917650638134B35D5D18F91174CD49DEA7E486428DC675A06D6C17B12EAD8304729C6DBA1297E4E27B685241D45E752E56FC6C990AFFE14096E25F6B8171278057EAFEF47B3831722DECBDBF209A89E9D48B77110BA6F1273D9201C67A6131F1866CAC3ED37C759681D78457A91CA621C35142E8275949EF95615098666DE5DD34EDFE503074857E6DBD7A05C09B3DFC455D498113094E5452E23E59593B544FE75B29FF89E20F6250CF041495549159A77ED67DA902E64FDC3AE1FE5538096852E3C6F519D3BBBA4862B859CDE331F483FDE4EBD49827B3D3F79A13BAB96023AAB60D8E512A56F484AC35836788546693EC21C75EA3DDF322583608F50D3EC7F2306CF120C4726BADBEEA0502E12DB0478E739F6CCF5F2D62AABE5C5834DBAC423FF84F88F143B7783B04645994921094FE04EBECD22BD4EAE716FBD9D821E58492CA96A14C7D86642EA62662279884B52DEDFBBFA3D099BD8FDB7CEAFE1A2DC30CBDE04BF8F4FB7EEDB688E7BEC3C957656CF8877AFC8A324853B1E44E918CE43DF85882EF07F85E7FE83401073AA050A6943BAE2D384BAB78EDB0397B13E7BAEA9DB4AE03D18891A74EB32111FED3B467F0E92B6965D291FF61EDDEE2613BD7793E00DB3FA95C626749C437E9B6013D970954426D51D08FF39778B5"""

    init {
        KeyProperty("kdjeuyfjkekhndlknvfdekljnolrhsdo")
        stringValCryptoReadingConverter = StringValCryptoReadingConverter()
        stringValCryptoWritingConverter = StringValCryptoWritingConverter()
    }

    @Test
    internal fun `Vil teste om vi klarer å dekryptere reell json kryptert med med lokal nøkkel`() {
        KeyProperty("Det finnes mange gode eksempler.") // bruk nøkkel fra lokal profil
        val string = kryptertJson.removeRange(0, 2) // fjern string 0x som sier denne er heksadesimal encodet
        val byteArray = hexStringToByteArray(string)

        val toDatabaseColumn = stringValCryptoReadingConverter.convert(byteArray)

        println(toDatabaseColumn?.data)
        assertThat(toDatabaseColumn?.data).startsWith("{\"innsendingsdetaljer\":{\"label\":\"Innsendingsdetaljer\",\"verdi\":{\"datoMottatt\":{\"label\":\"Dato mottatt\",\"verdi\":\"2022-06-29T15:46:41.127780458\",\"alternativer\":null,\"svarId\":null},")
    }

    fun hexStringToByteArray(hexString: String): ByteArray {
        val len = hexString.length
        val byteArray = ByteArray(len / 2)
        for (i in 0 until len step 2) {
            byteArray[i / 2] = ((hexString[i].digitToInt(16) shl 4) + hexString[i + 1].digitToInt(16)).toByte()
        }
        return byteArray
    }

    @Test
    internal fun `convertToDatabaseColumn konverterer input til String for lagring i base og tilbake til identisk string`() {
        val string = "Bob Marley"

        val convertToDatabaseColumn = stringValCryptoWritingConverter.convert(EncryptedString(string))

        assertThat(convertToDatabaseColumn).isNotEqualTo("Bob Marley")
    }

    @Test
    internal fun `convertToDatabaseColumn konverterer input til String for lagring i base`() {
        val string = "UQO9DFBIipAyzXzGIG6XmGT3fOBDdIFA6AvpH3Adpow="

        val toDatabaseColumn = stringValCryptoReadingConverter.convert(Base64.getDecoder().decode(string))

        assertThat(toDatabaseColumn?.data).isEqualTo("Bob Marley")
    }

    @Test
    fun byteArrayToEntityAttribute() {
        val byteArray = byteArrayOf('b'.code.toByte(), 'o'.code.toByte(), 'b'.code.toByte())

        val byteArrayToEntityAttribute = stringValCryptoReadingConverter.byteArrayToEntityAttribute(byteArray)

        assertThat(byteArrayToEntityAttribute?.data).isEqualTo("bob")
    }

    @Test
    fun entityAttributeToByteArray() {
        val byteArray = byteArrayOf('b'.code.toByte(), 'o'.code.toByte(), 'b'.code.toByte())

        val entityAttributeToByteArray = stringValCryptoWritingConverter.entityAttributeToByteArray(EncryptedString("bob"))

        assertThat(entityAttributeToByteArray).isEqualTo(byteArray)
    }
}
